# v8.0.0
type: sections
max_columns: 3
title: Solax & Octopus Settings
path: solax-settings
sections:
  - type: grid
    cards:
      - type: heading
        heading_style: title
        badges:
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.zappi_plug_status
            color: green
            visibility:
              - condition: state
                entity: sensor.zappi_plug_status
                state_not: EV Disconnected
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.octopus_total_planned_dispatch
            name: Planned Dispatch
            state_content:
              - name
              - state
            color: green
            tap_action:
              action: more-info
      - type: markdown
        content: >-
          {% if state_attr('sensor.octopus_total_planned_dispatch','dispatches')
          != None%}    

          Planned Dispatches

          {% set current =
          state_attr('sensor.octopus_total_planned_dispatch','dispatches')|list|
          map(attribute='dispatch') | list %}
            {% for dispatch in current%}
              {{dispatch}}
            {% endfor %}
          {%endif%}
        visibility:
          - condition: numeric_state
            entity: sensor.octopus_total_planned_dispatch
            above: 0
      - type: entities
        entities:
          - type: section
            label: >-
              Automation controls the inverter, smart charge and zappi mode, it
              responds to events such as car charging and Grid Supplier rate
              changes by controlling the Minimum SoC. It also handles
              exporting. 
          - entity: automation.solax_zappi_octopus_control
          - entity: input_number.delay_when_ev_connected
          - entity: switch.octopus_intelligent_smart_charge
          - entity: select.zappi_charge_mode
        show_header_toggle: false
        state_color: true
        title: Automation 5001 Controlled
        visibility:
          - condition: state
            entity: input_boolean.solax_octopus_hide_settings
            state: "on"
      - type: entities
        entities:
          - type: section
            label: Select when an octopus shedule can be requested.
          - entity: input_boolean.octopus_schedule_anytime
            state_color: true
            name: Smart Charge On Plugin
          - entity: input_boolean.use_fixed_time
            state_color: true
            name: Smart Charge at Fixed Time
          - entity: input_boolean.solar_export_priority
            state_color: true
            name: Smart Charge after Sunset
        show_header_toggle: false
        state_color: true
        title: EV Schedule Type
        visibility:
          - condition: state
            entity: input_boolean.solax_octopus_hide_settings
            state: "on"
      - type: conditional
        conditions:
          - condition: state
            entity: input_boolean.solar_export_priority
            state: "on"
          - condition: state
            entity: input_boolean.solax_octopus_hide_settings
            state: "on"
        card:
          type: entities
          entities:
            - type: section
            - entity: sensor.octopus_schedule_time
              format: datetime
            - entity: input_number.sun_degrees_above_horizon
            - entity: number.octopus_intelligent_charge_target
            - entity: select.octopus_intelligent_target_time
          title: Smart Charge After Sunset
      - type: conditional
        conditions:
          - condition: state
            entity: input_boolean.octopus_schedule_anytime
            state: "on"
          - condition: state
            entity: input_boolean.solax_octopus_hide_settings
            state: "on"
        card:
          type: entities
          entities:
            - type: section
            - entity: sensor.octopus_schedule_time
              format: datetime
            - entity: number.octopus_intelligent_charge_target
            - entity: select.octopus_intelligent_target_time
          title: Smart Charge Anytime
      - type: conditional
        conditions:
          - condition: and
            conditions:
              - condition: state
                entity: input_boolean.solar_export_priority
                state: "off"
              - condition: state
                entity: input_boolean.octopus_schedule_anytime
                state: "off"
          - condition: state
            entity: input_boolean.solax_octopus_hide_settings
            state: "on"
        card:
          type: entities
          entities:
            - type: section
            - entity: sensor.octopus_schedule_time
              format: datetime
            - entity: input_datetime.don_t_charge_ev_before_time
            - entity: number.octopus_intelligent_charge_target
            - entity: select.octopus_intelligent_target_time
          title: Smart Charge After Fixed Time
      - type: entities
        entities:
          - type: section
          - entity: input_boolean.zappi_eco_always
          - entity: number.zappi_minimum_green_level
        show_header_toggle: false
        state_color: true
        title: Eco Settings
        visibility:
          - condition: state
            entity: input_boolean.solax_octopus_hide_settings
            state: "on"
      - type: vertical-stack
        cards:
          - type: entities
            entities:
              - type: section
              - entity: input_boolean.solax_zappi_octopus_control_notifications
                name: Notifications
                state_color: true
              - entity: input_select.solax_automation_notification_devices
              - entity: input_button.solax_zappi_octopus_reset_device_list
              - entity: input_select.solax_zappi_octopus_notification_list
              - entity: input_button.solax_zappi_octopus_reset_notification_exclusions
            title: Notification Management
          - type: markdown
            content: >
              {% set list = namespace( members =
              state_attr('sensor.solax_zappi_octopus_notification_to_exclude',
              'notification_list') | map(attribute='notification') | list) %}


              {% set devicelist = namespace( members =
              state_attr('sensor.solax_zappi_octopus_devices_to_notify',
              'mobile_devices') | map(attribute='device') | list) %}


              {% if
              states('input_boolean.solax_zappi_octopus_control_notifications')
              == 'on' %}


              **Mobile Devices to Notify:**



              {% for devices in devicelist.members -%}

              {{devices}}

              {%endfor %}


              {% if list.members|length >= 1%}

              **Excluded Notifications:**

              {% endif %}


              {% for notification in list.members -%}

              {{notification}}

              {%endfor %}


              {% endif %}
                
            layout_options:
              grid_columns: 4
              grid_rows: 1
        visibility:
          - condition: state
            entity: input_boolean.solax_octopus_hide_settings
            state: "on"
  - type: grid
    cards:
      - type: heading
        heading_style: title
        badges:
          - type: entity
            show_state: false
            show_icon: true
            entity: input_boolean.solax_automation_running
            color: pink
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_house_load_power
            state_content:
              - name
              - state
            name: House Load
            color: light-green
            tap_action:
              action: more-info
          - type: entity
            show_icon: true
            entity: sensor.solax_discharge_capacity
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_battery_temperature
            tap_action:
              action: more-info
            name: Battery Temp
            state_content:
              - name
              - state
      - type: entities
        entities:
          - type: section
          - type: conditional
            conditions:
              - entity: binary_sensor.ev_gap_discharge_allowed
                state: "on"
            row:
              entity: binary_sensor.ev_gap_discharge_allowed
              name: Dispatch Gap Export
          - type: conditional
            conditions:
              - entity: binary_sensor.ev_gap_discharge_allowed
                state: "on"
            row:
              entity: sensor.battery_budget_reserve_soc
              name: Target SoC
          - type: conditional
            conditions:
              - entity: binary_sensor.ev_gap_discharge_allowed
                state: "on"
            row:
              entity: sensor.solax_local_battery_soc
              name: Current SoC
          - type: conditional
            conditions:
              - entity: binary_sensor.ev_gap_discharge_allowed
                state: "on"
            row:
              entity: input_boolean.battery_discharge_in_dispatch_gaps
              name: STOP
          - type: conditional
            conditions:
              - entity: binary_sensor.daily_export_discharge_allowed
                state: "on"
            row:
              entity: binary_sensor.daily_export_discharge_allowed
              name: Daily Export
          - type: conditional
            conditions:
              - entity: binary_sensor.daily_export_discharge_allowed
                state: "on"
            row:
              entity: sensor.battery_budget_reserve_soc
              name: Target SoC
          - type: conditional
            conditions:
              - entity: binary_sensor.daily_export_discharge_allowed
                state: "on"
            row:
              entity: sensor.solax_local_battery_soc
              name: Current SoC
          - type: conditional
            conditions:
              - entity: binary_sensor.daily_export_discharge_allowed
                state: "on"
            row:
              entity: input_boolean.export_battery_daily
              name: STOP
          - type: conditional
            conditions:
              - entity: binary_sensor.jit_2330_discharge_allowed
                state: "on"
            row:
              entity: binary_sensor.jit_2330_discharge_allowed
              name: Nightly Export
          - type: conditional
            conditions:
              - entity: binary_sensor.jit_2330_discharge_allowed
                state: "on"
            row:
              entity: input_number.solax_default_discharge_limit_soc
              name: Target SoC
          - type: conditional
            conditions:
              - entity: binary_sensor.jit_2330_discharge_allowed
                state: "on"
            row:
              entity: sensor.solax_local_battery_soc
              name: Current SoC
          - type: conditional
            conditions:
              - entity: binary_sensor.jit_2330_discharge_allowed
                state: "on"
            row:
              entity: input_boolean.export_battery_nightly
              name: STOP
          - type: conditional
            conditions:
              - entity: binary_sensor.manual_discharge_allowed
                state: "on"
            row:
              entity: binary_sensor.manual_discharge_allowed
          - type: conditional
            conditions:
              - entity: binary_sensor.manual_discharge_allowed
                state: "on"
            row:
              entity: input_number.solax_manual_forced_discharge_limit_soc
              name: Target SoC
          - type: conditional
            conditions:
              - entity: binary_sensor.manual_discharge_allowed
                state: "on"
            row:
              entity: sensor.solax_local_battery_soc
              name: Current SoC
          - type: conditional
            conditions:
              - entity: binary_sensor.manual_discharge_allowed
                state: "on"
            row:
              entity: input_button.solax_stop_discharge
              name: STOP
          - type: conditional
            conditions:
              - entity: binary_sensor.free_electric_discharge_allowed
                state: "on"
            row:
              entity: binary_sensor.free_electric_discharge_allowed
              name: Free Electric Battery Prep Export
          - type: conditional
            conditions:
              - entity: binary_sensor.free_electric_discharge_allowed
                state: "on"
            row:
              entity: input_number.octopus_free_session_battery_prep_soc
              name: Target SoC
          - type: conditional
            conditions:
              - entity: binary_sensor.free_electric_discharge_allowed
                state: "on"
            row:
              entity: sensor.solax_local_battery_soc
              name: Current SoC
        title: Battery Exporting Status
        visibility:
          - condition: or
            conditions:
              - condition: state
                entity: binary_sensor.free_electric_discharge_allowed
                state: "on"
              - condition: state
                entity: binary_sensor.jit_2330_discharge_allowed
                state: "on"
              - condition: state
                entity: binary_sensor.solax_discharge_before_ev_charge
                state: "on"
              - condition: state
                entity: binary_sensor.daily_export_discharge_allowed
                state: "on"
              - condition: state
                entity: binary_sensor.manual_discharge_allowed
                state: "on"
              - condition: state
                entity: binary_sensor.ev_gap_discharge_allowed
                state: "on"
        state_color: true
      - type: entities
        entities:
          - type: section
          - entity: sensor.solax_local_inverter_mode
          - type: conditional
            conditions:
              - entity: sensor.solax_local_manual_mode_behaviour
                state_not: Do Nothing
            row:
              entity: sensor.solax_local_manual_mode_behaviour
        title: Inverter Current Mode
      - type: history-graph
        hours_to_show: 15
        show_names: false
        entities:
          - entity: sensor.solax_local_feed_in_battery_min_soc
          - entity: sensor.solax_local_selfuse_battery_min_soc
          - entity: sensor.solax_local_battery_soc
          - entity: sensor.battery_budget_reserve_soc
          - entity: input_number.solax_manual_forced_discharge_limit_soc
        grid_options:
          columns: 12
          rows: 3
      - type: custom:power-flow-card-plus
        entities:
          battery:
            entity: sensor.solax_local_battery_power_adjusted
            state_of_charge: sensor.solax_local_battery_soc
            invert_state: true
          grid:
            entity:
              consumption: sensor.solax_local_grid_used_power
              production: sensor.solax_local_grid_export_power
          home:
            entity: sensor.solax_local_load_power
            color_value: true
            name: Home
            use_metadata: true
            override_state: true
          individual:
            - entity: sensor.zappi_power_ct_internal_load
              secondary_info: {}
              name: Zappi
              use_metadata: false
              display_zero: true
          fossil_fuel_percentage:
            state_type: power
            entity: sensor.electricity_maps_grid_fossil_fuel_percentage
            color_value: true
            color_icon: true
            display_zero: true
            name: Low Carbon
            unit_white_space: true
            use_metadata: true
            display_zero_state: false
          solar:
            entity: sensor.solax_local_pv_output
            color_value: true
            color_icon: true
        clickable_entities: true
        display_zero_lines:
          mode: transparency
          transparency: 50
          grey_color:
            - 189
            - 189
            - 189
        use_new_flow_rate_model: true
        w_decimals: 0
        kw_decimals: 1
        min_flow_rate: 0.75
        max_expected_power: 6000
        min_expected_power: 0.01
        watt_threshold: 1000
        transparency_zero_lines: 0
        max_flow_rate: 10
      - type: entities
        entities:
          - entity: input_button.solax_submit_settings
          - type: section
          - entity: input_boolean.inverter_modes_show_hide
          - entity: input_boolean.inverter_settings_show_hide
          - type: section
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_modes_show_hide
                state: "on"
            row:
              entity: input_select.solax_work_mode
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_modes_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Self Use
              - entity: input_select.solax_work_mode
                state_not: Feed In Priority
            row:
              entity: input_select.solax_manual_modes
          - type: section
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_modes_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: input_boolean.solax_system_enable
              name: Inverter Off/On
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state: Self Use
            row:
              entity: input_number.solax_selfuse_battery_min_soc
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state: Self Use
            row:
              entity: input_number.solax_selfuse_charge_to_soc
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state: Feed In Priority
            row:
              entity: input_number.solax_feed_in_battery_min_soc
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state: Feed In Priority
            row:
              entity: input_number.solax_feed_in_charge_to_soc
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: input_datetime.solax_battery_start_discharge_time
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: input_datetime.solax_battery_stop_discharge_time
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state: Self Use
            row:
              entity: input_boolean.self_use_enable_charge_from_grid
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: input_datetime.solax_battery_start_charge_time
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: input_datetime.solax_battery_stop_charge_time
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: input_boolean.solaxchargeperiod2
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: input_datetime.solax_start_charge_2
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: input_datetime.solax_stop_charge_2
          - type: section
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: sensor.solax_local_battery_heat_enabled
              name: Battery Heating
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: sensor.solax_local_battery_heat_level
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: sensor.solax_local_battery_heat_start
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: sensor.solax_local_battery_heat_stop
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: sensor.solax_local_battery_heat_start_2
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_settings_show_hide
                state: "on"
              - entity: input_select.solax_work_mode
                state_not: Manual
            row:
              entity: sensor.solax_local_battery_heat_stop_2
          - type: section
          - entity: input_boolean.inverter_default_behaviours_show_hide
          - type: section
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_default_behaviours_show_hide
                state: "on"
            row:
              entity: input_select.solax_default_mode
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_default_behaviours_show_hide
                state: "on"
            row:
              entity: input_number.solax_default_discharge_limit_soc
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_default_behaviours_show_hide
                state: "on"
            row:
              entity: input_number.solax_default_charge_to_limit_soc
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_default_behaviours_show_hide
                state: "on"
            row:
              entity: input_number.solax_inverter_capacity
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_default_behaviours_show_hide
                state: "on"
            row:
              entity: input_number.solax_battery_capacity
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_default_behaviours_show_hide
                state: "on"
            row:
              entity: input_number.solax_battery_soh_stored
          - type: section
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_default_behaviours_show_hide
                state: "on"
            row:
              entity: input_boolean.use_grid_during_octopus_dispatch
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_default_behaviours_show_hide
                state: "on"
            row:
              entity: input_boolean.solax_can_see_zappi_loads
          - type: conditional
            conditions:
              - entity: input_boolean.inverter_default_behaviours_show_hide
                state: "on"
            row:
              entity: input_boolean.ev_solax_battery_drain
        visibility:
          - condition: state
            entity: input_boolean.solax_octopus_hide_settings
            state: "on"
        title: Inverter Controls and Behaviours
        state_color: true
        show_header_toggle: false
    column_span: 1
  - type: grid
    cards:
      - type: heading
        heading_style: title
        badges:
          - type: entity
            show_state: true
            show_icon: false
            entity: sensor.solcast_pv_forecast_forecast_remaining_today
            tap_action:
              action: more-info
            state_content:
              - name
              - state
            name: Forecast
          - type: entity
            show_state: true
            show_icon: false
            entity: sensor.solax_local_pv_output
            color: green
            state_content:
              - name
              - state
            name: PV
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: false
            entity: sensor.solax_local_inverter_power
            name: Inverter Power
            state_content:
              - name
              - state
            color: accent
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: false
            entity: sensor.solax_local_grid_export_power
            name: Export
            state_content:
              - name
              - state
            color: accent
            tap_action:
              action: more-info
        tap_action:
          action: none
      - type: entities
        entities:
          - type: section
          - entity: input_boolean.gap_export_show_hide
          - entity: input_boolean.battery_discharge_in_dispatch_gaps
          - type: conditional
            conditions:
              - entity: input_boolean.gap_export_show_hide
                state: "on"
              - entity: sensor.octopus_next_gap_duration
                type: attribute
                attribute: next_gap_start
                state_not: ""
            row:
              entity: sensor.octopus_next_gap_duration
              name: Next Gap Start
              type: attribute
              attribute: next_gap_start
          - type: conditional
            conditions:
              - entity: input_boolean.gap_export_show_hide
                state: "on"
              - entity: sensor.octopus_next_gap_duration
                type: attribute
                attribute: next_gap_end
                state_not: ""
            row:
              entity: sensor.octopus_next_gap_duration
              name: Next Gap End
              type: attribute
              attribute: next_gap_end
          - type: conditional
            conditions:
              - entity: input_boolean.gap_export_show_hide
                state: "on"
            row:
              entity: input_number.battery_discharge_soc_window_limit
          - type: section
          - entity: input_boolean.daily_export_show_hide
          - entity: input_boolean.export_battery_daily
          - type: conditional
            conditions:
              - entity: input_boolean.daily_export_show_hide
                state: "on"
            row:
              entity: input_boolean.daily_export_when_ev_connected
          - type: conditional
            conditions:
              - entity: input_boolean.daily_export_show_hide
                state: "on"
            row:
              entity: input_number.daily_battery_discharge_soc_window_limit
          - type: conditional
            conditions:
              - entity: input_boolean.daily_export_show_hide
                state: "on"
            row:
              entity: input_datetime.daily_battery_export_time
          - type: section
          - entity: input_boolean.nightly_export_show_hide
          - entity: input_boolean.export_battery_nightly
          - type: conditional
            conditions:
              - entity: input_boolean.nightly_export_show_hide
                state: "on"
            row:
              entity: input_boolean.nightly_export_when_ev_connected
          - type: conditional
            conditions:
              - entity: input_boolean.nightly_export_show_hide
                state: "on"
            row:
              entity: input_number.battery_export_margin_delta
          - type: conditional
            conditions:
              - entity: input_boolean.nightly_export_show_hide
                state: "on"
            row:
              entity: input_number.nightly_battery_discharge_soc_window_limit
          - type: conditional
            conditions:
              - entity: input_boolean.nightly_export_show_hide
                state: "on"
            row:
              entity: binary_sensor.jit_2330_discharge_allowed
              name: Nightly Export
              type: attribute
              attribute: just_in_time_start_2330
          - type: section
          - entity: input_number.solax_manual_forced_discharge_limit_soc
          - entity: input_button.solax_force_discharge
          - entity: input_button.solax_stop_discharge
        title: Exports
        show_header_toggle: false
        state_color: true
        visibility:
          - condition: state
            entity: input_boolean.solax_octopus_hide_settings
            state: "on"
      - type: entities
        entities:
          - type: section
          - entity: input_boolean.battery_reserve_show_hide
          - entity: sensor.solax_local_battery_soc
            name: Current SoC
          - entity: sensor.battery_budget_reserve_soc
            name: Total Reserved
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: sensor.battery_budget_reserve_soc
              name: Required SoC to get to E.O.D
              type: attribute
              attribute: reserve_soc_eod
              suffix: "%"
          - entity: sensor.battery_budget_reserve_soc
            name: Deficit (SoC below Reserve)
            type: attribute
            attribute: deficit
            suffix: "%"
          - type: section
            label: >-
              Reserves - Specify an additional % Reserve and/either/or number of
              hours of typical house power. By setting these, the target SoC is
              raised which any GAP or DAILY exports will respect
          - entity: input_number.additional_reserve_soc
          - entity: input_number.hours_of_reserve_energy
          - entity: input_select.ignore_additional_reserve_after
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: sensor.battery_budget_reserve_soc
              name: Additional Reserve SoC
              type: attribute
              attribute: additional_reserve_soc
              suffix: "%"
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: sensor.battery_budget_reserve_kwh
              type: attribute
              attribute: additional_reserve_kwh
              name: Additional Reserve kWh
              suffix: kWh
          - type: section
            label: >-
              The battery reserve is calculated from historical home usage (+ a
              small cost for running the inverter). Enter the number of days you
              wish to use and the time range you run on battery. This calculates
              the minimum battery level you need to survive until the end of the
              day. It requires at least 1 complete day of data to work but
              suggest you use at least 8 days. 
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: input_number.power_stat_avg_days
              name: Days to use
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: input_select.slot_start
              name: Start
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: input_select.slot_end
              name: End
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: input_select.slot_interval
              name: Interval
          - type: section
            label: Additional Details
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: sensor.solax_discharge_capacity
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: sensor.battery_exportable_allowance_kwh
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: sensor.battery_budget_reserve_kwh
              name: Total Reserved
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: sensor.battery_budget_reserve_kwh
              name: Required kWh to get to E.O.D
              type: attribute
              attribute: reserve_kwh_eod
              suffix: kWh
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: sensor.battery_budget_reserve_soc
              name: Required SoC to get to E.O.D
              type: attribute
              attribute: reserve_soc_eod
              suffix: "%"
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: sensor.battery_budget_reserve_soc
              name: Default Min SoC
              type: attribute
              attribute: min_soc
              suffix: "%"
          - type: conditional
            conditions:
              - entity: input_boolean.battery_reserve_show_hide
                state: "on"
            row:
              entity: sensor.solax_local_battery_soh
        show_header_toggle: false
        title: Battery Reserves
        state_color: true
        visibility:
          - condition: state
            entity: input_boolean.solax_octopus_hide_settings
            state: "on"
      - type: conditional
        conditions:
          - condition: or
            conditions:
              - condition: and
                conditions:
                  - condition: or
                    conditions:
                      - condition: state
                        entity: binary_sensor.upcoming_free_electricity
                        state: "on"
                      - condition: state
                        entity: binary_sensor.free_electricity_today
                        state: "on"
                  - condition: state
                    entity: input_boolean.solax_octopus_hide_settings
                    state: "off"
              - condition: and
                conditions:
                  - condition: state
                    entity: input_boolean.solax_octopus_hide_settings
                    state: "on"
        card:
          type: entities
          entities:
            - type: section
            - entity: input_boolean.free_electric
            - entity: sensor.octopus_free_electricity_start
              format: datetime
            - entity: sensor.octopus_free_electricity_stop
              secondary_info: none
              format: datetime
            - entity: input_boolean.octopus_free_electric_soc_use
            - entity: input_number.octopus_free_session_battery_prep_soc
            - entity: input_datetime.octopus_free_electricity_prep
            - entity: binary_sensor.free_electricity_today
          state_color: true
          title: Free Electric Sessions
          show_header_toggle: false
    column_span: 1
  - type: grid
    cards:
      - type: heading
        heading_style: title
        badges:
          - type: entity
            show_state: false
            show_icon: true
            entity: input_boolean.solax_automation_running
            color: pink
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_battery_soc
            state_content:
              - name
              - state
            color: green
            name: Battery
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_battery_temperature
            tap_action:
              action: more-info
            state_content:
              - name
              - state
            name: Battery Temp
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_pv_output
            color: green
            state_content:
              - name
              - state
            name: PV
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_inverter_power
            name: Inverter Power
            state_content:
              - name
              - state
            color: accent
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_house_load_power
            name: House Load
            tap_action:
              action: more-info
            state_content:
              - name
              - state
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_grid_export_power
            name: Export
            state_content:
              - name
              - state
            color: green
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_grid_power
            color: red
            state_content:
              - name
              - state
            tap_action:
              action: more-info
            name: Grid Power
      - type: history-graph
        entities:
          - entity: sensor.solax_local_inverter_mode
          - entity: sensor.solax_local_manual_mode_behaviour
          - entity: binary_sensor.solax_local_battery_charging_period
          - entity: select.daily_grid_import
            name: Log
          - entity: binary_sensor.octopus_energy_electricity_off_peak
          - entity: binary_sensor.octopus_intelligent_dispatching
          - entity: sensor.zappi_plug_status
          - entity: sensor.zappi_status
          - entity: sensor.solax_runmode
        fit_y_data: true
        hours_to_show: 36
        grid_options:
          columns: 36
          rows: auto
      - title: SoC
        type: history-graph
        hours_to_show: 36
        entities:
          - entity: sensor.solax_local_feed_in_battery_min_soc
          - entity: sensor.solax_local_selfuse_battery_min_soc
          - entity: sensor.solax_local_battery_soc
          - entity: sensor.battery_budget_reserve_soc
          - entity: input_number.solax_manual_forced_discharge_limit_soc
          - entity: sensor.solax_local_selfuse_battery_chrg_frm_grd_to
          - entity: sensor.solax_local_feed_in_battery_charge_from_grid_to
          - entity: input_number.solax_default_charge_to_limit_soc
          - entity: input_number.solax_default_discharge_limit_soc
        grid_options:
          columns: 36
          rows: auto
      - type: history-graph
        entities:
          - entity: select.daily_grid_import
            name: Log
        fit_y_data: true
        hours_to_show: 36
        grid_options:
          columns: 36
          rows: auto
      - title: Solax Energy
        type: history-graph
        hours_to_show: 36
        entities:
          - entity: sensor.daily_total_stored
          - entity: sensor.daily_grid_stored
          - entity: sensor.daily_solar_stored
          - entity: sensor.daily_battery_use
          - entity: sensor.daily_self_consumed
          - entity: sensor.daily_house_load
          - entity: sensor.daily_manual_battery_export
          - entity: sensor.export_daily
          - entity: sensor.solax_discharge_capacity
          - entity: sensor.solcast_pv_forecast_forecast_remaining_today
          - entity: sensor.battery_budget_reserve_kwh
        grid_options:
          columns: 36
          rows: auto
        fit_y_data: true
    column_span: 3
    visibility:
      - condition: state
        entity: input_boolean.solax_octopus_hide_energy
        state: "on"
  - cards:
      - type: heading
        heading_style: title
        badges:
          - type: entity
            show_state: false
            show_icon: true
            entity: input_boolean.solax_automation_running
            color: pink
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_battery_soc
            state_content:
              - name
              - state
            color: green
            name: Battery
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_battery_temperature
            tap_action:
              action: more-info
            state_content:
              - name
              - state
            name: Battery Temp
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_pv_output
            color: green
            state_content:
              - name
              - state
            name: PV
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_inverter_power
            name: Inverter Power
            state_content:
              - name
              - state
            color: accent
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_house_load_power
            name: House Load
            tap_action:
              action: more-info
            state_content:
              - name
              - state
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_grid_export_power
            name: Export
            state_content:
              - name
              - state
            color: green
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.solax_local_grid_power
            color: red
            state_content:
              - name
              - state
            tap_action:
              action: more-info
            name: Grid Power
        heading: Power Sensors
      - type: history-graph
        entities:
          - entity: select.daily_grid_import
            name: Log
        fit_y_data: true
        hours_to_show: 36
        grid_options:
          columns: 36
          rows: auto
      - title: Solax Power
        type: history-graph
        hours_to_show: 36
        entities:
          - entity: sensor.solax_local_battery_use_in
          - entity: sensor.solax_local_battery_use_in_from_grid
          - entity: sensor.solax_local_battery_in_from_solar
          - entity: sensor.solax_local_battery_power_adjusted
          - entity: sensor.solax_local_self_consumption_power
          - entity: sensor.solax_local_house_load_power
          - entity: sensor.solax_local_battery_dump_power
          - entity: sensor.solax_local_grid_export_power
          - entity: sensor.solax_local_inverter_in_power
        grid_options:
          columns: 36
          rows: auto
      - type: history-graph
        entities:
          - entity: select.daily_grid_import
            name: Log
        fit_y_data: true
        hours_to_show: 36
        grid_options:
          columns: 36
          rows: auto
      - type: history-graph
        entities:
          - entity: sensor.solax_local_load_power
          - entity: sensor.solax_local_grid_power
          - entity: sensor.solax_local_inverter_power
          - entity: sensor.solax_local_pv_output
          - entity: sensor.solax_local_pv_output_string_1
          - entity: sensor.solax_local_pv_output_string_2
          - entity: sensor.solcast_pv_forecast_power_now
          - entity: sensor.zappi_power_ct_internal_load
          - entity: sensor.zappi_power_ct_grid_load
        grid_options:
          columns: 36
          rows: auto
        hours_to_show: 36
        title: Load In/Out
      - type: history-graph
        entities:
          - entity: select.daily_grid_import
            name: Log
        fit_y_data: true
        hours_to_show: 36
        grid_options:
          columns: 36
          rows: auto
      - title: Cell Voltage (Pack Voltage/X cells)
        type: history-graph
        hours_to_show: 36
        entities:
          - entity: sensor.solax_local_battery_cell_voltage
        grid_options:
          columns: 36
          rows: auto
        min_y_axis: 3
      - title: Battery Temperature
        type: history-graph
        hours_to_show: 36
        entities:
          - entity: sensor.solax_local_battery_temperature
        grid_options:
          columns: 36
          rows: auto
      - title: " Grid Stored/Theoretical Grid Stored= Capacity SoH"
        type: history-graph
        hours_to_show: 1500
        entities:
          - entity: sensor.solax_grid_stored_at_first_max_soc
        fit_y_data: false
        grid_options:
          columns: 36
          rows: auto
        min_y_axis: 9
      - title: " Grid Stored/Theoretical Grid Stored= Capacity SoH"
        type: history-graph
        hours_to_show: 1500
        entities:
          - entity: sensor.solax_local_battery_soh
          - entity: sensor.solax_local_min_soc
          - entity: sensor.solax_local_max_soc
          - entity: sensor.solax_local_battery_temperature
        fit_y_data: false
        grid_options:
          columns: 36
          rows: auto
    column_span: 3
    visibility:
      - condition: state
        entity: input_boolean.solax_octopus_hide_power
        state: "on"
  - type: grid
    cards:
      - type: heading
        heading: Energy Stats
        heading_style: title
      - type: vertical-stack
        cards:
          - type: statistic
            entity: sensor.monthly_grid_import_free
            period:
              calendar:
                period: day
            stat_type: change
            name: Free Import
          - type: statistic
            entity: sensor.monthly_grid_import_peak
            period:
              calendar:
                period: day
            stat_type: change
            name: Peak Import
          - type: statistic
            entity: sensor.monthly_grid_import_offpeak
            period:
              calendar:
                period: day
            stat_type: change
            name: Off peak Import
          - type: statistic
            entity: sensor.solax_local_inverter_aggregated_energy
            period:
              calendar:
                period: day
            stat_type: change
            name: Solar Yield
          - type: statistic
            entity: sensor.solax_local_grid_export_aggregated_energy
            period:
              calendar:
                period: day
            stat_type: change
            name: Total Export
          - type: statistic
            entity: sensor.solax_local_battery_dump_aggregated_energy
            period:
              calendar:
                period: day
            stat_type: change
            name: Forced Battery Export
          - type: statistic
            entity: sensor.zappi_charging
            period:
              calendar:
                period: day
            stat_type: change
            name: Zappi
          - type: statistic
            period:
              calendar:
                period: day
            stat_type: change
            name: House Usage
            entity: sensor.solax_local_house_load_aggregated_energy
          - type: statistic
            entity: sensor.solax_local_self_consumption_aggregated_energy
            period:
              calendar:
                period: day
            stat_type: change
            name: Solax Self Consumption
          - type: statistic
            entity: sensor.solax_local_battery_out_aggregated_energy
            period:
              calendar:
                period: day
            stat_type: change
            name: Battery Used for House
          - type: statistic
            entity: sensor.solax_local_battery_in_from_grid_aggregated_energy
            period:
              calendar:
                period: day
            stat_type: change
            name: DC Grid Stored
          - type: statistic
            entity: sensor.solax_local_battery_in_from_solar_aggregated_energy
            period:
              calendar:
                period: day
            stat_type: change
            name: Solar Stored
        title: Today
        grid_options:
          columns: 6
      - type: vertical-stack
        cards:
          - type: statistic
            entity: sensor.monthly_grid_import_free
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: Free Import
          - type: statistic
            entity: sensor.monthly_grid_import_peak
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: Peak Import
          - type: statistic
            entity: sensor.monthly_grid_import_offpeak
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: Off peak Import
          - type: statistic
            entity: sensor.solax_local_inverter_aggregated_energy
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: Solar Yield
          - type: statistic
            entity: sensor.solax_local_grid_export_aggregated_energy
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: Total Export
          - type: statistic
            entity: sensor.solax_local_battery_dump_aggregated_energy
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: Forced Battery Export
          - type: statistic
            entity: sensor.zappi_charging
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: Zappi
          - type: statistic
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: House Usage
            entity: sensor.solax_local_house_load_aggregated_energy
          - type: statistic
            entity: sensor.solax_local_self_consumption_aggregated_energy
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: Solax Self Consumption
          - type: statistic
            entity: sensor.solax_local_battery_out_aggregated_energy
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: Battery Used for House
          - type: statistic
            entity: sensor.solax_local_battery_in_from_grid_aggregated_energy
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: DC Grid Stored
          - type: statistic
            entity: sensor.solax_local_battery_in_from_solar_aggregated_energy
            period:
              calendar:
                period: day
                offset: -1
            stat_type: change
            name: Solar Stored
        grid_options:
          columns: 6
        title: Yesterday
      - type: vertical-stack
        cards:
          - type: statistic
            entity: sensor.monthly_grid_import_free
            period:
              calendar:
                period: month
            stat_type: change
            name: Free Import
          - type: statistic
            entity: sensor.monthly_grid_import_peak
            period:
              calendar:
                period: month
            stat_type: change
            name: Peak Import
          - type: statistic
            entity: sensor.monthly_grid_import_offpeak
            period:
              calendar:
                period: month
            stat_type: change
            name: Off peak Import
          - type: statistic
            entity: sensor.solax_local_inverter_aggregated_energy
            period:
              calendar:
                period: month
                offset: 0
            stat_type: change
            name: Solar Yield
          - type: statistic
            entity: sensor.solax_local_grid_export_aggregated_energy
            period:
              calendar:
                period: month
            stat_type: change
            name: Total Export
          - type: statistic
            entity: sensor.solax_local_battery_dump_aggregated_energy
            period:
              calendar:
                period: month
            stat_type: change
            name: Forced Battery Export
          - type: statistic
            entity: sensor.zappi_charging
            period:
              calendar:
                period: month
            stat_type: change
            name: Zappi
          - type: statistic
            period:
              calendar:
                period: month
            stat_type: change
            name: House Usage
            entity: sensor.solax_local_house_load_aggregated_energy
          - type: statistic
            entity: sensor.solax_local_self_consumption_aggregated_energy
            period:
              calendar:
                period: month
            stat_type: change
            name: Solax Self Consumption
          - type: statistic
            entity: sensor.solax_local_battery_out_aggregated_energy
            period:
              calendar:
                period: month
            stat_type: change
            name: Battery Used for House
          - type: statistic
            entity: sensor.solax_local_battery_in_from_grid_aggregated_energy
            period:
              calendar:
                period: month
            stat_type: change
            name: DC Grid Stored
          - type: statistic
            entity: sensor.solax_local_battery_in_from_solar_aggregated_energy
            period:
              calendar:
                period: month
            stat_type: change
            name: Solar Stored
        grid_options:
          columns: 6
        title: This Month
      - type: vertical-stack
        cards:
          - type: statistic
            entity: sensor.monthly_grid_import_free
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: Free Import
          - type: statistic
            entity: sensor.monthly_grid_import_peak
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: Peak Import
          - type: statistic
            entity: sensor.monthly_grid_import_offpeak
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: Off peak Import
          - type: statistic
            entity: sensor.solax_local_inverter_aggregated_energy
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: Solar Yield
          - type: statistic
            entity: sensor.solax_local_grid_export_aggregated_energy
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: Total Export
          - type: statistic
            entity: sensor.solax_local_battery_dump_aggregated_energy
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: Forced Battery Export
          - type: statistic
            entity: sensor.zappi_charging
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: Zappi
          - type: statistic
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: House Usage
            entity: sensor.solax_local_house_load_aggregated_energy
          - type: statistic
            entity: sensor.solax_local_self_consumption_aggregated_energy
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: Solax Self Consumption
          - type: statistic
            entity: sensor.solax_local_battery_out_aggregated_energy
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: Battery Used for House
          - type: statistic
            entity: sensor.solax_local_battery_in_from_grid_aggregated_energy
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: DC Grid Stored
          - type: statistic
            entity: sensor.solax_local_battery_in_from_solar_aggregated_energy
            period:
              calendar:
                period: month
                offset: -1
            stat_type: change
            name: Solar Stored
        grid_options:
          columns: 6
        title: Last Month
      - type: vertical-stack
        cards:
          - type: statistic
            entity: sensor.monthly_grid_import_free
            period:
              calendar:
                period: year
            stat_type: change
            name: Free Import
          - type: statistic
            entity: sensor.monthly_grid_import_peak
            period:
              calendar:
                period: year
            stat_type: change
            name: Peak Import
          - type: statistic
            entity: sensor.monthly_grid_import_offpeak
            period:
              calendar:
                period: year
            stat_type: change
            name: Off peak Import
          - type: statistic
            entity: sensor.solax_local_inverter_aggregated_energy
            period:
              calendar:
                period: year
            stat_type: change
            name: Solar Yield
          - type: statistic
            entity: sensor.solax_local_grid_export_aggregated_energy
            period:
              calendar:
                period: year
            stat_type: change
            name: Total Export
          - type: statistic
            entity: sensor.solax_local_battery_dump_aggregated_energy
            period:
              calendar:
                period: year
            stat_type: change
            name: Forced Battery Export
          - type: statistic
            entity: sensor.zappi_charging
            period:
              calendar:
                period: year
            stat_type: change
            name: Zappi
          - type: statistic
            period:
              calendar:
                period: year
            stat_type: change
            name: House Usage
            entity: sensor.solax_local_house_load_aggregated_energy
          - type: statistic
            entity: sensor.solax_local_self_consumption_aggregated_energy
            period:
              calendar:
                period: year
            stat_type: change
            name: Solax Self Consumption
          - type: statistic
            entity: sensor.solax_local_battery_out_aggregated_energy
            period:
              calendar:
                period: year
            stat_type: change
            name: Battery Used for House
          - type: statistic
            entity: sensor.solax_local_battery_in_from_grid_aggregated_energy
            period:
              calendar:
                period: year
            stat_type: change
            name: DC Grid Stored
          - type: statistic
            entity: sensor.solax_local_battery_in_from_solar_aggregated_energy
            period:
              calendar:
                period: year
            stat_type: change
            name: Solar Stored
        grid_options:
          columns: 6
        title: This Year
      - type: vertical-stack
        cards:
          - type: statistic
            entity: sensor.monthly_grid_import_free
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: Free Import
          - type: statistic
            entity: sensor.monthly_grid_import_peak
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: Peak Import
          - type: statistic
            entity: sensor.monthly_grid_import_offpeak
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: Off peak Import
          - type: statistic
            entity: sensor.solax_local_inverter_aggregated_energy
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: Solar Yield
          - type: statistic
            entity: sensor.solax_local_grid_export_aggregated_energy
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: Total Export
          - type: statistic
            entity: sensor.solax_local_battery_dump_aggregated_energy
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: Forced Battery Export
          - type: statistic
            entity: sensor.zappi_charging
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: Zappi
          - type: statistic
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: House Usage
            entity: sensor.solax_local_house_load_aggregated_energy
          - type: statistic
            entity: sensor.solax_local_self_consumption_aggregated_energy
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: Solax Self Consumption
          - type: statistic
            entity: sensor.solax_local_battery_out_aggregated_energy
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: Battery Used for House
          - type: statistic
            entity: sensor.solax_local_battery_in_from_grid_aggregated_energy
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: DC Grid Stored
          - type: statistic
            entity: sensor.solax_local_battery_in_from_solar_aggregated_energy
            period:
              calendar:
                period: year
                offset: -1
            stat_type: change
            name: Solar Stored
        grid_options:
          columns: 6
        title: Last Year
      - chart_type: bar
        period: month
        type: statistics-graph
        entities:
          - entity: sensor.solax_local_grid_used_aggregated_energy
            name: Grid Used
          - entity: sensor.zappi_ct_grid_used_aggregated_energy
            name: Grid Used (Zappi CT)
          - entity: sensor.zappi_charging
            name: Zappi
          - entity: sensor.solax_local_grid_export_aggregated_energy
            name: Total Export
          - entity: sensor.zappi_ct_grid_export_aggregated_energy
            name: Total Export (Zappi CT)
          - entity: sensor.solax_local_house_load_aggregated_energy
            name: House Load
        stat_types:
          - change
        days_to_show: 366
        grid_options:
          columns: full
          rows: 8
        title: Stats Summary - Last 12 Months
      - chart_type: bar
        period: month
        type: statistics-graph
        entities:
          - entity: sensor.solax_local_grid_used_aggregated_energy
            name: Grid Used
          - entity: sensor.zappi_ct_grid_used_aggregated_energy
            name: Grid Used (Zappi CT)
          - entity: sensor.zappi_charging
            name: Zappi
          - entity: sensor.solax_local_grid_export_aggregated_energy
            name: Total Export
          - entity: sensor.zappi_ct_grid_export_aggregated_energy
            name: Total Export (Zappi CT)
          - entity: sensor.solax_local_house_load_aggregated_energy
            name: House Load
          - entity: sensor.solax_local_inverter_aggregated_energy
            name: Yield
          - entity: sensor.solax_local_battery_dump_aggregated_energy
            name: Battery Export
          - entity: sensor.solax_local_battery_in_from_solar_aggregated_energy
            name: Solar Stored
          - entity: sensor.solax_local_self_consumption_aggregated_energy
            name: Self Use
          - entity: sensor.solax_local_battery_out_aggregated_energy
            name: Battery Use
        stat_types:
          - change
        days_to_show: 366
        grid_options:
          columns: full
          rows: 8
        title: Detailed Stats Summary - Last 12 Months
    column_span: 3
    visibility:
      - condition: state
        entity: input_boolean.solax_octopus_hide_stats
        state: "on"
cards: []
badges:
  - type: entity
    show_name: false
    show_state: false
    show_icon: true
    color: pink
    entity: input_boolean.solax_automation_running
    name: Automations Running
    tap_action:
      action: none
  - type: entity
    show_name: true
    show_state: false
    show_icon: true
    entity: input_boolean.solax_octopus_hide_settings
    tap_action:
      action: toggle
    name: Show/Hide Settings
  - type: entity
    show_name: true
    show_state: false
    show_icon: true
    entity: input_boolean.solax_octopus_hide_energy
    tap_action:
      action: toggle
  - type: entity
    show_name: true
    show_state: false
    show_icon: true
    entity: input_boolean.solax_octopus_hide_power
    tap_action:
      action: toggle
  - type: entity
    show_name: true
    show_state: false
    show_icon: true
    entity: input_boolean.solax_octopus_hide_stats
    show_entity_picture: false
    tap_action:
      action: toggle
dense_section_placement: true
icon: ""
subview: false

