# replace zappi_XXXXXXXX with your zappi regno
# replace z_ZZZZZZZZ with your octopus account
# v5.6.4 Bug Fix - Wrong entity in nightly soc target
# v5.6.0 Tweaks to go with release
# v5.4.1 Tweaks to go with release
# v5.3.0 Minor update to show hide charge period 2 when the switch is enabled
# v5.0.1 Minor update to include Export Margin Delta (min)
# v5.0   Refactored
# v4.0.  Predicted production using Solcast
#        Added a Battery SoH sensor to help discharge pridictions
#        Added a predicted Shcedule start time based on EV battery size
# v3.8   Added function to estimate what time EV needs to start based on % charge required and target time
# v3.7   Added pre emptive discharge options
# v3.2.2 Added switches to hide/unhide bits of the dashboard
# v3.2.1 Added house load power to the Heading Card
# v3.2   Dashboard tidy
# v3.1   Added better notification options and cell voltage
#        Added Solax System On/Off
# v3.0.5 Added missing titles to load chart
# v3.0.4 Tidy up of charts
# v3.0.3 Chart presentation improvement
# v3.0.1 Added new charting params
# v3.0.0 Various enhancments to go with the release
type: sections
max_columns: 3
title: Solax & Octopus Settings
path: solax-settings
sections:
  - type: grid
    cards:
      - type: heading
        heading_style: title
        badges:
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.zappi_plug_status
            color: green
            visibility:
              - condition: state
                entity: sensor.zappi_plug_status
                state_not: EV Disconnected
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.octopus_total_planned_dispatch
            name: Planned Dispatch
            state_content:
              - name
              - state
            color: green
            tap_action:
              action: more-info
          - type: entity
            show_state: true
            show_icon: false
            entity: sensor.octopus_completed_dispatch
            name: Completed
            visibility:
              - condition: state
                entity: binary_sensor.octopus_intelligent_dispatching
                state: "on"
              - condition: state
                entity: sensor.zappi_plug_status
                state: EV Connected
            tap_action:
              action: more-info
            state_content:
              - name
              - state
          - type: entity
            show_state: true
            show_icon: true
            entity: sensor.octopus_completed_dispatch
            visibility:
              - condition: state
                entity: sensor.zappi_plug_status
                state: Charging
            tap_action:
              action: more-info
            state_content:
              - name
              - state
            name: Completed
      - type: markdown
        content: >-
          {% if state_attr('sensor.octopus_total_planned_dispatch','dispatches')
          != None%}    

          Planned Dispatches

